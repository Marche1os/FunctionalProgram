При изучении вопроса наткнулся на подход "Pattern Specification via Relative Coordinates".

Суть в том, что мы уходим от жестко закодированной логики поиска совпадений и определяем условия Match как набор правил и топологических связей относительно исходной точки.

Ключевая идея это отделить топологию от предикатов и эффектов.

Вместо абсолютной матрицы мы используем разреженное представление - список смещений относительно точки проверки (Anchor). 
Это позволяет описывать любые формы, не храня пустые нули. 

Кроме этого у нас появляется и пространство для улучшения производительности, если это будет необходимо.